<textarea id="features" placeholder="Enter 30 values separated by commas..."></textarea>
<button onclick="submitData()">🚀 Predict</button>
<div class="result" id="output"></div>

<script>
async function submitData() {
  const output = document.getElementById("output");
  output.className = "result loading";
  output.innerHTML = "⏳ Predicting...";

  const inputText = document.getElementById("features").value.trim();
  if (!inputText) {
    output.className = "result error";
    output.innerHTML = "❌ Please enter 30 values!";
    return;
  }

  const values = inputText.split(",").map(v => parseFloat(v.trim()));
  if (values.length !== 30 || values.some(v => isNaN(v))) {
    output.className = "result error";
    output.innerHTML = "❌ Invalid input. Enter exactly 30 numbers.";
    return;
  }

  const keys = Array.from({length:28}, (_,i)=>`V${i+1}`).concat(["Time","Amount"]);
  const payload = Object.fromEntries(keys.map((k,i)=>[k,values[i]]));

  try {
    const res = await fetch("https://credit-card-fraud-mlops-2.onrender.com/predict", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });
    if (!res.ok) throw new Error(`Server returned ${res.status}`);
    const data = await res.json();
    output.className = "result " + (data.prediction === 1 ? "error" : "success");
    output.innerHTML = data.prediction === 1 ? "⚠ Prediction: FRAUD 🚨" : "✅ Prediction: NOT FRAUD 🎉";
  } catch(err) {
    output.className = "result error";
    output.innerHTML = `❌ Error: ${err.message}`;
  }
}
</script>
